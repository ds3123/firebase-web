(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4259],{1081:function(e,t,s){Promise.resolve().then(s.bind(s,5155))},5155:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ea}});var a=s(7437),r=s(2265),l=s(8712),n=s(9213),o=s(2549),c=s(2169);let d=l.fC,i=l.xz;l.x8;let m=l.h_,u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.aV,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});u.displayName=l.aV.displayName;let x=(0,n.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=r.forwardRef((e,t)=>{let{side:s="right",className:r,children:n,...d}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(l.VY,{ref:t,className:(0,c.cn)(x({side:s}),r),...d,children:[n,(0,a.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=l.VY.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.Dx,{ref:t,className:(0,c.cn)("text-lg font-semibold text-foreground",s),...r})});p.displayName=l.Dx.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.dk,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",s),...r})}).displayName=l.dk.displayName;var h=s(575);function j(e){let{children:t,button_title:s,sheet_title:r,button_style:l}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(i,{asChild:!0,children:(0,a.jsxs)(h.z,{className:"".concat(l),children:[" ",s," "]})}),(0,a.jsxs)(f,{className:"sm:max-w-[1000px] space-y-8",children:[(0,a.jsxs)(p,{className:"label",children:[" ",r,"  "]}),t]})]})}function N(e){let{button_title:t,sheet_title:s,query_fn:l,component:n}=e,[o,c]=(0,r.useState)(null);return(0,r.useEffect)(()=>{l().then(e=>{c(e)})},[]),(0,a.jsx)(j,{button_title:t,sheet_title:s,button_style:"bg-indigo-100 text-indigo-600 hover:bg-indigo-200",children:n(o)})}var y=s(8110),g=s(1865),_=s(4578),b=s(7256),w=s(6743);let v=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),I=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(w.f,{ref:t,className:(0,c.cn)(v(),s),...r})});I.displayName=w.f.displayName;let R=g.RV,C=r.createContext({}),Z=e=>{let{...t}=e;return(0,a.jsx)(C.Provider,{value:{name:t.name},children:(0,a.jsx)(g.Qr,{...t})})},F=()=>{let e=r.useContext(C),t=r.useContext(V),{getFieldState:s,formState:a}=(0,g.Gc)(),l=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...l}},V=r.createContext({}),k=r.forwardRef((e,t)=>{let{className:s,...l}=e,n=r.useId();return(0,a.jsx)(V.Provider,{value:{id:n},children:(0,a.jsx)("div",{ref:t,className:(0,c.cn)("space-y-2",s),...l})})});k.displayName="FormItem";let E=r.forwardRef((e,t)=>{let{className:s,...r}=e,{error:l,formItemId:n}=F();return(0,a.jsx)(I,{ref:t,className:(0,c.cn)(l&&"text-destructive",s),htmlFor:n,...r})});E.displayName="FormLabel";let K=r.forwardRef((e,t)=>{let{...s}=e,{error:r,formItemId:l,formDescriptionId:n,formMessageId:o}=F();return(0,a.jsx)(b.g7,{ref:t,id:l,"aria-describedby":r?"".concat(n," ").concat(o):"".concat(n),"aria-invalid":!!r,...s})});K.displayName="FormControl",r.forwardRef((e,t)=>{let{className:s,...r}=e,{formDescriptionId:l}=F();return(0,a.jsx)("p",{ref:t,id:l,className:(0,c.cn)("text-sm text-muted-foreground",s),...r})}).displayName="FormDescription";let z=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e,{error:n,formMessageId:o}=F(),d=n?String(null==n?void 0:n.message):r;return d?(0,a.jsx)("p",{ref:t,id:o,className:(0,c.cn)("text-sm font-medium text-destructive",s),...l,children:d}):null});z.displayName="FormMessage";var S=s(2782),D=s(6337),J=s(3523),T=s(9224),Y=s(2442);let q=D.fC;D.ZA;let B=D.B4,G=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(D.xz,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(D.JO,{asChild:!0,children:(0,a.jsx)(J.Z,{className:"h-4 w-4 opacity-50"})})]})});G.displayName=D.xz.displayName;let P=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(T.Z,{className:"h-4 w-4"})})});P.displayName=D.u_.displayName;let A=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(J.Z,{className:"h-4 w-4"})})});A.displayName=D.$G.displayName;let L=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...n}=e;return(0,a.jsx)(D.h_,{children:(0,a.jsxs)(D.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...n,children:[(0,a.jsx)(P,{}),(0,a.jsx)(D.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(A,{})]})})});L.displayName=D.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=D.__.displayName;let M=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(D.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(D.wU,{children:(0,a.jsx)(Y.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(D.eT,{children:r})]})});M.displayName=D.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(D.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=D.Z0.displayName;var O=s(4086),Q=s(8439);let U=_.Ry({customer_name:_.Z_().min(1,{message:"姓名需至少輸入一個字"}),customer_sex:_.Km(["男","女"]),customer_mobile:_.Z_().min(1,{message:"手機號碼需至少輸入一個字"}),customer_telephone:_.Z_().optional(),customer_email:_.Z_().optional(),customer_line:_.Z_().optional(),customer_address:_.Z_().optional(),customer_id:_.Z_().optional(),customer_note:_.Z_().optional()});function $(e){let{data:t}=e,s=(0,g.cI)({resolver:(0,y.F)(U),defaultValues:t||{customer_name:"",customer_mobile:"",customer_telephone:"",customer_email:"",customer_line:"",customer_address:"",customer_id:"",customer_note:""}});async function r(e){let t=await (0,O.ET)((0,O.hJ)(Q.Nx,"customers"),e);alert("新增客戶成功，文件 id 為 : ".concat(t.id))}let l=e=>{};return(0,a.jsx)(R,{...s,children:(0,a.jsxs)("form",{onSubmit:s.handleSubmit(r),className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 p-2",children:[(0,a.jsx)(Z,{control:s.control,name:"customer_name",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsxs)(E,{className:"relative",children:[(0,a.jsx)("span",{className:"required",children:" * "})," 姓 名"]}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入姓名",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_sex",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsxs)(E,{className:"relative",children:[(0,a.jsx)("span",{className:"absolute -top-2 -left-2 text-red-600 font-extrabold",children:" * "})," 性 別"]}),(0,a.jsxs)(q,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,a.jsx)(K,{children:(0,a.jsx)(G,{children:(0,a.jsx)(B,{placeholder:"請選擇"})})}),(0,a.jsxs)(L,{children:[(0,a.jsx)(M,{value:"男",children:"男"}),(0,a.jsx)(M,{value:"女",children:"女"})]})]}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_mobile",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsxs)(E,{className:"relative",children:[(0,a.jsx)("span",{className:"required",children:" * "})," 手機號碼"]}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{onChangeCapture:e=>l(e.currentTarget.value),placeholder:"輸入手機號碼",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_telephone",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsx)(E,{className:"relative",children:"家用電話"}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入家用電話",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_email",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsx)(E,{children:" E-mail "}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入 E-mail",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_line",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsx)(E,{children:" Line "}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入 Line",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_address",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1 col-span-2",children:[(0,a.jsx)(E,{children:" 通訊地址 "}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入通訊地址",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_id",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1",children:[(0,a.jsx)(E,{children:" 身份證字號 "}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入身份證字號",...t})}),(0,a.jsx)(z,{})]})}}),(0,a.jsx)(Z,{control:s.control,name:"customer_note",render:e=>{let{field:t}=e;return(0,a.jsxs)(k,{className:"space-y-1 col-span-3",children:[(0,a.jsx)(E,{children:" 客戶備註 "}),(0,a.jsx)(K,{children:(0,a.jsx)(S.I,{placeholder:"輸入客戶備註",...t})}),(0,a.jsx)(z,{})]})}})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(h.z,{type:"submit",children:" 提 交 "})})]})})}let H=async e=>{let t=(0,O.JU)(Q.Nx,"customers",e);return(await (0,O.QT)(t)).data()},W=e=>(0,a.jsx)($,{data:e}),X=[{accessorKey:"customer_name",header:"客戶姓名",cell:e=>{let{row:t}=e,s=t.original;return(0,a.jsx)(N,{button_title:s.customer_name,sheet_title:"修改客戶資料",query_fn:()=>H(s.id),component:W})}},{accessorKey:"customer_sex",header:"客戶性別",cell:e=>{let{row:t}=e;return t.getValue("customer_sex")}},{accessorKey:"customer_mobile",header:"手機號碼",cell:e=>{let{row:t}=e;return t.getValue("customer_mobile")}},{accessorKey:"customer_telephone",header:"家用電話",cell:e=>{let{row:t}=e;return t.getValue("customer_mobile")}},{accessorKey:"customer_pets",header:"客戶寵物"},{accessorKey:"customer_address",header:"通訊地址",cell:e=>{let{row:t}=e;return t.getValue("customer_address")}},{accessorKey:"customer_history",header:"消費歷史"},{accessorKey:"customer_created_at",header:"建檔日期"}];function ee(e){let{button_title:t,sheet_title:s,component:r}=e;return(0,a.jsx)(j,{button_title:t,sheet_title:s,children:r})}var et=s(1977);let es=()=>{let[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=(0,O.cf)((0,O.hJ)(Q.Nx,"customers"),e=>{t(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>e()},[]),e};function ea(){let e=es();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)(ee,{button_title:"新增客戶",sheet_title:"新增客戶",component:(0,a.jsx)($,{})})}),(0,a.jsx)(et.DataTable,{columns:X,data:e,filter:["customer_name"]})]})}},8439:function(e,t,s){"use strict";s.d(t,{Nx:function(){return c}});var a=s(994),r=s(4086),l=s(9584);let n={apiKey:s(2601).env.FIREBASE_API_KEY,authDomain:"web-api-f5107.firebaseapp.com",projectId:"web-api-f5107",storageBucket:"web-api-f5107.appspot.com",messagingSenderId:"19499484520",appId:"1:19499484520:web:4fd05ea09b3f5fcd0e42dd",measurementId:"G-63JZSBJTCE"},o=(0,a.C6)().length?(0,a.Mq)():(0,a.ZF)(n),c=(0,r.ad)(o);(0,l.cF)(o)}},function(e){e.O(0,[4358,167,845,2790,3943,1615,1977,2971,4938,1744],function(){return e(e.s=1081)}),_N_E=e.O()}]);